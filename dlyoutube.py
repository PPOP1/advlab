"""
================================================================================
    โปรแกรมดาวน์โหลดวิดีโอจากยูทูป (YouTube Video Downloader)
================================================================================

คำอธิบายสั้น ๆ:
    สคริปต์นี้รับ URL ของวิดีโอ YouTube จากผู้ใช้ แล้วใช้ไลบรารี `yt_dlp`
    เพื่อดาวน์โหลดวิดีโอในคุณภาพที่ดีที่สุดและบันทึกเป็นไฟล์บนโฟลเดอร์
    ปัจจุบัน (หรือโฟลเดอร์ที่กำหนดผ่าน `outtmpl`).

สิ่งที่ไฟล์นี้มี:
    - ฟังก์ชัน `download_youtube(url)` : ตั้งค่าการดาวน์โหลดและเรียก `yt_dlp`.
    - บล็อก `if __name__ == "__main__"` : รับ URL จากผู้ใช้และเรียกฟังก์ชัน.

ความต้องการ (Requirements):
    - ติดตั้งไลบรารี yt-dlp: `pip install yt-dlp`
    - ต้องเชื่อมต่ออินเทอร์เน็ต

ตัวอย่างการใช้งาน:
    pip install yt-dlp
    python dlyoutube.py

คำแนะนำสั้น ๆ:
    - กำหนด `outtmpl` หากต้องการเปลี่ยนโฟลเดอร์เก็บไฟล์ (เช่น 'downloads/%(title)s.%(ext)s').
    - อ่านเอกสาร `yt-dlp` สำหรับตัวเลือก `format` และการตั้งค่าอื่น ๆ.

================================================================================
"""

# นำเข้าไลบรารี yt-dlp สำหรับดาวน์โหลดวิดีโอ YouTube
import yt_dlp


def download_youtube(url):
    """
    ฟังก์ชันดาวน์โหลดวิดีโอจาก YouTube
    
    รายละเอียด (Description):
        - ฟังก์ชันนี้รับ URL ของวิดีโอ YouTube
        - ดาวน์โหลดวิดีโอในคุณภาพที่ดีที่สุด
        - บันทึกไฟล์ในโฟลเดอร์ปัจจุบัน
    
    พารามิเตอร์ (Parameters):
        url (string): ลิงก์เต็มของวิดีโอ YouTube
                      เช่น https://www.youtube.com/watch?v=dQw4w9WgXcQ
    
    ค่าที่คืนกลับ (Return):
        ไม่มี (None) - เพียงแค่สร้างไฟล์วิดีโอลงในเครื่อง
    
    ตัวอย่างการใช้ (Example):
        download_youtube("https://www.youtube.com/watch?v=dQw4w9WgXcQ")
    """
    
    # ====== ส่วนที่ 1: สร้างการตั้งค่า (Configuration) ======
    # สร้าง dictionary ที่เก็บตัวเลือกต่างๆ สำหรับการดาวน์โหลด
    # คำอธิบายตัวเลือกหลัก:
    #   - 'format': ระบุรูปแบบ/คุณภาพของสื่อที่ต้องการ ('best' = คุณภาพสูงสุด)
    #   - 'outtmpl': รูปแบบชื่อไฟล์ที่บันทึก (เครื่องหมาย %()s มาจาก yt-dlp metadata)
    # ตัวอย่าง: '%(title)s.%(ext)s' จะถูกแทนที่ด้วยชื่อวิดีโอและนามสกุล
    ydl_opts = {
        # 'format': ตั้งคุณภาพของวิดีโอที่จะดาวน์โหลด
        # 'best' = เลือกคุณภาพดีที่สุดที่มี
        'format': 'best',
        
        # 'outtmpl': กำหนดรูปแบบของชื่อไฟล์ที่บันทึก
        # %(title)s = ชื่อของวิดีโอต้นฉบับ
        # %(ext)s = นามสกุลไฟล์ (เช่น mp4, webm)
        'outtmpl': '%(title)s.%(ext)s'
    }

    # ====== ส่วนที่ 2: ดาวน์โหลดวิดีโอ (Download) ======
    # สร้าง object ของ YoutubeDL และเรียกดาวน์โหลด
    # - ใช้ `with` เพื่อให้แน่ใจว่า resources จะถูกปิดอัตโนมัติ
    # - ฟังก์ชัน `download()` รับลิสต์ของ URL จึงส่ง [url]
    with yt_dlp.YoutubeDL(ydl_opts) as ydl:
        # เริ่มดาวน์โหลด (จะพิมพ์สถานะ/progress ไปยังคอนโซลโดยค่าเริ่มต้นของ yt-dlp)
        ydl.download([url])


# ====== ส่วนที่ 3: โปรแกรมหลัก (Main Program) ======
if __name__ == "__main__":
    """
    ตรงนี้เป็นจุดเริ่มต้นของโปรแกรม (Entry point)
    
    if __name__ == "__main__": ความหมาย:
        - เพียงแค่รันไฟล์นี้โดยตรง (ไม่ได้ import มาจากไฟล์อื่น)
        - ป้องกันไม่ให้โปรแกรมรันเมื่อไฟล์นี้ถูก import
    
    ขั้นตอนการทำงาน:
        1. แสดงข้อความยินดีต้อนรับ
        2. ขอให้ผู้ใช้ป้อน URL
        3. เรียกฟังก์ชัน download_youtube()
        4. แสดงข้อความการเสร็จสิ้น
    """
    
    # แสดงชื่อโปรแกรม
    print("=== YouTube Downloader ===")
    
    # ขอให้ผู้ใช้ป้อนข้อมูล: URL ของวิดีโอ YouTube
    # input() = ดึงข้อมูลจากคีย์บอร์ด
    # "กรุณาใส่ URL ของ YouTube: " = ข้อความแสดงบอกผู้ใช้
    video_url = input("กรุณาใส่ URL ของ YouTube: ")
    # ทำความสะอาด input: เอาช่องว่างหัว/ท้ายออก
    video_url = video_url.strip()
    # ถ้าผู้ใช้ไม่ได้ป้อนค่า แจ้งและออกได้ทันที
    if not video_url:
        print("ไม่พบ URL. กรุณารันโปรแกรมอีกครั้งและใส่ URL ของวิดีโอ.")
    else:
    
        # เรียกใช้ฟังก์ชันดาวน์โหลด
        download_youtube(video_url)
        # แสดงข้อความเมื่อเสร็จสิ้นการดาวน์โหลด
        print("ดาวน์โหลดเสร็จสิ้น")